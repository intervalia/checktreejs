<script>
(function(){function a(l,m){var n=document.createElement(l);return m&&Object.keys(m).forEach(function(o){n.setAttribute(o,m[o])}),n}function b(l,m){var n=l;return m.substr(2).split('.').some(function(o){return n=n.children[isNaN(o)?-1:parseInt(o,10)],void 0===n},this),n}function c(l){return'String'===Object.prototype.toString.call(l).slice(8,-1)}function d(l){var m=l.el.querySelector('ul');m&&m.remove(),m=a('ul',{'class':'checktree-group'}),l.el.appendChild(m),l.children.forEach(function(n){var p='checktree-node';n.hasChildren&&(p+=' checktree-parent'),n.opened&&(p+=' checktree-opened');var q=a('li',{'class':p});m.appendChild(q);var r=a('input',{type:'checkbox'});if(r.checked=n.checked,q.appendChild(r),q.appendChild(document.createTextNode(' '+(n.label||n.value||''))),n.hasChildren){var s=a('button',{'class':'checktree-toggle'});s.textContent='\u25BA',q.appendChild(s)}n.el=q,r.ctOption=n,0<n.children.length&&d(n)})}function f(l){var m=new CustomEvent('changed',{detail:l._root.checkedValues});l.dispatchEvent(m)}var g=!!HTMLElement.prototype.attachShadow;class i{constructor(l='',m=''){this.id='r',this._checked=!1,this._opened=!1,this.children=[],this.hasChildren=!1,this._label=l,this.value=m}_addChild(l,m){var n=new i(l.label,l.value),o=this.children.length;if(n.parent=this,this.checked&&(n.checked=this.checked),n.id=this.id+'.'+o,this.children.push(n),Array.isArray(l.children)&&0<l.children.length){var p='number'==typeof m?m-1:m;0>p&&(p=0),n.hasChildren=!0,n.addChildren(l.children,p),n.opened=m}else n.hasChildren=!!l.hasChildren}addChildren(l,m){l.forEach(n=>{this._addChild(n,m)},this)}removeChildren(){this.children.forEach(l=>{l.removeChildren(),l.el&&l.el.remove()}),this.opened=!1,this.children=[],this.checked===void 0&&(this.checked=!1)}setCheckFromChildren(){var l=!1;if(this._checked=!0,this.children.forEach(function(n){!1!==n.checked&&(l=!0),!0!==n.checked&&(this._checked=!1)},this),!1===this._checked&&l&&(this._checked=void 0),this.el){var m=this.el.firstChild;m.checked=this._checked,m.classList.toggle('checktree-cb-partial',void 0===this._checked)}this.parent&&this.parent.setCheckFromChildren()}get checked(){return this._checked}set checked(l){if(this._checked=l,this.el){var m=this.el.firstChild;m.checked=l,m.classList.toggle('checktree-cb-partial',void 0===l)}this.children.forEach(function(n){n.checked=l}),this.parent&&this.parent.setCheckFromChildren()}get checkedValues(){var l=[];return this.children.forEach(function(m){m.checked&&l.push({key:m.id,value:m.value}),m.children&&(l=l.concat(m.checkedValues))}),l}get label(){return this._label}set label(l){this._label=l,this.el&&(this.el.firstChild.nextSibling.textContent=' '+l)}get opened(){return this._opened}set opened(l){this._opened=l,this.el&&11!==this.el.nodeType&&this.el.classList.toggle('checktree-opened',l)}}var j=a('style',{'data-type':'checktree'});j.textContent='.checktree-group{padding-left:20px;} .checktree-node{list-style:none;position:relative;} .checktree-cb-partial {position: relative;} .checktree-cb-partial:after{background-color: #99999E;bottom: 4px;content: "";left:3px;position:absolute;right:3px;top:2px;} .checktree-toggle{background:transparent;border:none;display:none;left:-15px;margin:0;padding:3px 0;position:absolute;} .checktree-parent > .checktree-toggle{display:inline-block;} .checktree-node > ul{display: none;} .checktree-opened > .checktree-toggle{transform:rotate(90deg);} .checktree-opened > ul{display:block;}';class k extends HTMLElement{constructor(){super(),this._root=new i,this._root.el=g?this.attachShadow({mode:'closed'}):this,this._root.el.addEventListener('click',l=>{var m;if(l.target.classList.contains('checktree-toggle')&&(l.preventDefault(),m=l.target.parentNode.firstChild.ctOption,m.opened=!m.opened,m.opened&&0===m.children.length)){var n={node:m.id},o=new CustomEvent('load',{detail:n});this.dispatchEvent(o)}}),this._root.el.addEventListener('change',l=>{var m=l.target,n=m.ctOption;n.checked=m.checked,f(this)})}connectedCallback(){g?this._root.el.appendChild(j.cloneNode(!0)):!document.querySelector('style[data-type=checktree]')&&document.head.appendChild(j)}get checkedValues(){return this._root.checkedValues}addOptions(l,m=null,n){var o=this._root;if(!Array.isArray(l))throw new TypeError('`options` must be an array of options');if(0<l.length){if(!0===m&&void 0===n?(n=!0,m=null):'number'!=typeof n&&(n=!0===n||!1),c(m)&&1<m.length){if(o=b(this._root,m),!o)throw new ReferenceError('There is no entry for the `parentId` of '+m);}else if(null!==m&&'r'!==m)throw new TypeError('`parentId` must be null or a string');o.addChildren(l,n),d(o),f(this)}}changeLabel(l,m){if(!c(m))throw new TypeError('`nodeId` must be a string.');if(!c(l))throw new TypeError('`label` must be a string.');var n=b(this._root,m);if(!n)throw new ReferenceError('`nodeId` was not found;');n.label=l}isChecked(l){if(!c(l))throw new TypeError('`nodeId` must be a string.');var m=b(this._root,l);if(!m)throw new ReferenceError('`nodeId` was not found;');return m.checked}removeOptions(l){if(l!==void 0&&!c(l))throw new TypeError('`parentId` must be a string or `undefined`.');var m=l===void 0?this._root:b(this._root,l);if(!m)throw new ReferenceError('`parentId` was not found;');m.removeChildren()}setChecked(l,m){if(!c(l))throw new TypeError('`nodeId` must be a string.');var n=b(this._root,l);if(!n)throw new ReferenceError('`nodeId` was not found;');n.checked=!!m}}window.customElements.define('check-tree',k)})();
</script>
